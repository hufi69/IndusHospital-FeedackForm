// Language translations for doctor form
const translations = {
    en: {
      formTitle: "Doctor Technical Support",
      formSubtitle: "Report technical issues and get instant AI-powered solutions",
      empCodeLabel: "Employee Code *",
      issueTypeLabel: "Select Issue Type *",
      selectOption: "-- Select an Issue --",
      systemCrash: "System Crash",
      loginIssue: "Login Problem",
      printerIssue: "Printer Not Working",
      slowPerformance: "Slow Performance",
      internetDown: "Internet Connection Down",
      softwareError: "Software Error",
      hardwareMalfunction: "Hardware Malfunction",
      otherIssue: "Other",
      otherDescLabel: "Describe the Issue",
      submitBtn: "ðŸ¤– Get AI Solution",
      solutionTitle: "AI-Generated Solution",
      videoBtn: "Watch AI Video Guide",
      resolvedBtn: "Mark as Resolved",
      escalateBtn: "Escalate to IT",
      videoTitle: "AI-Generated Video Guide",
      langText: "Ø§Ø±Ø¯Ùˆ",
      // Error messages
      empCodeRequired: "Employee code is required",
      issueTypeRequired: "Please select an issue type",
      empCodeInvalid: "Please enter a valid employee code",
      // AI Processing messages
      analyzingIssue: "AI is analyzing your issue...",
      generatingSolution: "Generating personalized solution...",
      creatingVideo: "Creating custom video guide...",
      aiError: "AI service temporarily unavailable. Using backup solution.",
    },
    ur: {
      formTitle: "ÚˆØ§Ú©Ù¹Ø± ØªÚ©Ù†ÛŒÚ©ÛŒ Ø³Ù¾ÙˆØ±Ù¹",
      formSubtitle: "ØªÚ©Ù†ÛŒÚ©ÛŒ Ù…Ø³Ø§Ø¦Ù„ Ú©ÛŒ Ø§Ø·Ù„Ø§Ø¹ Ø¯ÛŒÚº Ø§ÙˆØ± AI Ø³Û’ Ú†Ù„Ù†Û’ ÙˆØ§Ù„Û’ ÙÙˆØ±ÛŒ Ø­Ù„ Ø­Ø§ØµÙ„ Ú©Ø±ÛŒÚº",
      empCodeLabel: "Ù…Ù„Ø§Ø²Ù… Ú©ÙˆÚˆ *",
      issueTypeLabel: "Ù…Ø³Ø¦Ù„Û’ Ú©ÛŒ Ù‚Ø³Ù… Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº *",
      selectOption: "-- Ø§ÛŒÚ© Ù…Ø³Ø¦Ù„Û Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº --",
      systemCrash: "Ø³Ø³Ù¹Ù… Ú©Ø±ÛŒØ´",
      loginIssue: "Ù„Ø§Ú¯ Ø§Ù† Ú©Ø§ Ù…Ø³Ø¦Ù„Û",
      printerIssue: "Ù¾Ø±Ù†Ù¹Ø± Ú©Ø§Ù… Ù†ÛÛŒÚº Ú©Ø± Ø±ÛØ§",
      slowPerformance: "Ø³Ø³Øª Ú©Ø§Ø±Ú©Ø±Ø¯Ú¯ÛŒ",
      internetDown: "Ø§Ù†Ù¹Ø±Ù†ÛŒÙ¹ Ú©Ù†Ú©Ø´Ù† Ø¨Ù†Ø¯",
      softwareError: "Ø³Ø§ÙÙ¹ ÙˆÛŒØ¦Ø± Ú©ÛŒ Ø®Ø±Ø§Ø¨ÛŒ",
      hardwareMalfunction: "ÛØ§Ø±Úˆ ÙˆÛŒØ¦Ø± Ú©ÛŒ Ø®Ø±Ø§Ø¨ÛŒ",
      otherIssue: "Ø¯ÛŒÚ¯Ø±",
      otherDescLabel: "Ù…Ø³Ø¦Ù„Û’ Ú©ÛŒ ÙˆØ¶Ø§Ø­Øª Ú©Ø±ÛŒÚº",
      submitBtn: "ðŸ¤– AI Ø­Ù„ Ø­Ø§ØµÙ„ Ú©Ø±ÛŒÚº",
      solutionTitle: "AI Ø³Û’ ØªÛŒØ§Ø± Ú©Ø±Ø¯Û Ø­Ù„",
      videoBtn: "AI ÙˆÛŒÚˆÛŒÙˆ Ú¯Ø§Ø¦ÛŒÚˆ Ø¯ÛŒÚ©Ú¾ÛŒÚº",
      resolvedBtn: "Ø­Ù„ Ø´Ø¯Û Ú©Û’ Ø·ÙˆØ± Ù¾Ø± Ù†Ø´Ø§Ù† Ø²Ø¯ Ú©Ø±ÛŒÚº",
      escalateBtn: "IT Ú©Ùˆ Ø¨Ú¾ÛŒØ¬ÛŒÚº",
      videoTitle: "AI Ø³Û’ ØªÛŒØ§Ø± Ú©Ø±Ø¯Û ÙˆÛŒÚˆÛŒÙˆ Ú¯Ø§Ø¦ÛŒÚˆ",
      langText: "English",
      // Error messages
      empCodeRequired: "Ù…Ù„Ø§Ø²Ù… Ú©ÙˆÚˆ Ø¶Ø±ÙˆØ±ÛŒ ÛÛ’",
      issueTypeRequired: "Ø¨Ø±Ø§Û Ú©Ø±Ù… Ù…Ø³Ø¦Ù„Û’ Ú©ÛŒ Ù‚Ø³Ù… Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº",
      empCodeInvalid: "Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø¯Ø±Ø³Øª Ù…Ù„Ø§Ø²Ù… Ú©ÙˆÚˆ Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº",
      // AI Processing messages
      analyzingIssue: "AI Ø¢Ù¾ Ú©Û’ Ù…Ø³Ø¦Ù„Û’ Ú©Ø§ ØªØ¬Ø²ÛŒÛ Ú©Ø± Ø±ÛØ§ ÛÛ’...",
      generatingSolution: "Ø°Ø§ØªÛŒ Ø­Ù„ ØªÛŒØ§Ø± Ú©Ø± Ø±ÛØ§ ÛÛ’...",
      creatingVideo: "Ø®ØµÙˆØµÛŒ ÙˆÛŒÚˆÛŒÙˆ Ú¯Ø§Ø¦ÛŒÚˆ Ø¨Ù†Ø§ Ø±ÛØ§ ÛÛ’...",
      aiError: "AI Ø³Ø±ÙˆØ³ Ø¹Ø§Ø±Ø¶ÛŒ Ø·ÙˆØ± Ù¾Ø± Ø¯Ø³ØªÛŒØ§Ø¨ Ù†ÛÛŒÚºÛ” Ø¨ÛŒÚ© Ø§Ù¾ Ø­Ù„ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø± Ø±ÛØ§ ÛÛ’Û”",
    },
  }

// AI Configuration
const AI_CONFIG = {
  // You can replace this with your actual OpenAI API key
  // For demo purposes, we'll use a mock AI service
  useRealAI: false, // Set to true when you have API key
  apiKey: 'your-openai-api-key-here',
  model: 'gpt-3.5-turbo',
  maxTokens: 500
}

// Enhanced AI Solutions with dynamic generation
const aiSolutions = {
  system_crash: {
    en: "1. Save any open work immediately\n2. Press Ctrl+Alt+Del to open Task Manager\n3. End any unresponsive applications\n4. If system is frozen, perform a hard restart by holding power button\n5. After restart, run Windows Memory Diagnostic\n6. Check for Windows updates\n7. If problem persists, contact IT department",
    ur: "1. ÙÙˆØ±ÛŒ Ø·ÙˆØ± Ù¾Ø± Ú©Ú¾Ù„Ø§ ÛÙˆØ§ Ú©Ø§Ù… Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº\n2. Ù¹Ø§Ø³Ú© Ù…Ù†ÛŒØ¬Ø± Ú©Ú¾ÙˆÙ„Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ctrl+Alt+Del Ø¯Ø¨Ø§Ø¦ÛŒÚº\n3. ØºÛŒØ± Ø¬ÙˆØ§Ø¨Ø¯Û Ø§ÛŒÙ¾Ù„ÛŒÚ©ÛŒØ´Ù†Ø² Ú©Ùˆ Ø¨Ù†Ø¯ Ú©Ø±ÛŒÚº\n4. Ø§Ú¯Ø± Ø³Ø³Ù¹Ù… Ù…Ù†Ø¬Ù…Ø¯ ÛÛ’ ØªÙˆ Ù¾Ø§ÙˆØ± Ø¨Ù¹Ù† Ø¯Ø¨Ø§ Ú©Ø± Ø³Ø®Øª Ø±ÛŒ Ø³Ù¹Ø§Ø±Ù¹ Ú©Ø±ÛŒÚº\n5. Ø±ÛŒ Ø³Ù¹Ø§Ø±Ù¹ Ú©Û’ Ø¨Ø¹Ø¯ ÙˆÙ†ÚˆÙˆØ² Ù…ÛŒÙ…ÙˆØ±ÛŒ ÚˆØ§Ø¦ÛŒÚ¯Ù†ÙˆØ³Ù¹Ú© Ú†Ù„Ø§Ø¦ÛŒÚº\n6. ÙˆÙ†ÚˆÙˆØ² Ø§Ù¾ÚˆÛŒÙ¹Ø³ Ú†ÛŒÚ© Ú©Ø±ÛŒÚº\n7. Ø§Ú¯Ø± Ù…Ø³Ø¦Ù„Û Ø¨Ø±Ù‚Ø±Ø§Ø± Ø±ÛÛ’ ØªÙˆ IT ÚˆÛŒÙ¾Ø§Ø±Ù¹Ù…Ù†Ù¹ Ø³Û’ Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº",
    video: "dQw4w9WgXcQ",
    aiPrompt: "A doctor is experiencing a system crash on their hospital computer. Provide step-by-step troubleshooting steps for a medical professional who needs to quickly resolve this issue to continue patient care."
  },
  login_issue: {
    en: "1. Verify your username and password are correct\n2. Check if Caps Lock is on\n3. Try typing password in a text editor first to verify\n4. Clear browser cache and cookies\n5. Try using a different browser\n6. Reset password using 'Forgot Password' option\n7. Contact IT if account is locked",
    ur: "1. Ø§Ù¾Ù†Ø§ ØµØ§Ø±Ù Ù†Ø§Ù… Ø§ÙˆØ± Ù¾Ø§Ø³ ÙˆØ±Úˆ Ø¯Ø±Ø³Øª ÛÙˆÙ†Û’ Ú©ÛŒ ØªØµØ¯ÛŒÙ‚ Ú©Ø±ÛŒÚº\n2. Ú†ÛŒÚ© Ú©Ø±ÛŒÚº Ú©Û Caps Lock Ø¢Ù† ØªÙˆ Ù†ÛÛŒÚº\n3. Ù¾ÛÙ„Û’ Ù¹ÛŒÚ©Ø³Ù¹ Ø§ÛŒÚˆÛŒÙ¹Ø± Ù…ÛŒÚº Ù¾Ø§Ø³ ÙˆØ±Úˆ Ù¹Ø§Ø¦Ù¾ Ú©Ø± Ú©Û’ ØªØµØ¯ÛŒÙ‚ Ú©Ø±ÛŒÚº\n4. Ø¨Ø±Ø§Ø¤Ø²Ø± Ú©ÛŒØ´ Ø§ÙˆØ± Ú©ÙˆÚ©ÛŒØ² ØµØ§Ù Ú©Ø±ÛŒÚº\n5. Ù…Ø®ØªÙ„Ù Ø¨Ø±Ø§Ø¤Ø²Ø± Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±Ù†Û’ Ú©ÛŒ Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚº\n6. 'Ù¾Ø§Ø³ ÙˆØ±Úˆ Ø¨Ú¾ÙˆÙ„ Ú¯Ø¦Û’' Ø¢Ù¾Ø´Ù† Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø± Ú©Û’ Ù¾Ø§Ø³ ÙˆØ±Úˆ Ø±ÛŒ Ø³ÛŒÙ¹ Ú©Ø±ÛŒÚº\n7. Ø§Ú¯Ø± Ø§Ú©Ø§Ø¤Ù†Ù¹ Ù„Ø§Ú© ÛÛ’ ØªÙˆ IT Ø³Û’ Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº",
    video: "dQw4w9WgXcQ",
    aiPrompt: "A doctor cannot log into the hospital system. Provide specific troubleshooting steps for medical staff login issues, considering hospital security protocols."
  },
  printer_not_working: {
    en: "1. Check if printer is powered on and connected\n2. Verify USB/Network cable connections\n3. Check paper tray and ink/toner levels\n4. Clear any paper jams\n5. Restart the printer\n6. Update or reinstall printer drivers\n7. Set as default printer in Windows settings\n8. Run Windows printer troubleshooter",
    ur: "1. Ú†ÛŒÚ© Ú©Ø±ÛŒÚº Ú©Û Ù¾Ø±Ù†Ù¹Ø± Ø¢Ù† ÛÛ’ Ø§ÙˆØ± Ø¬Ú‘Ø§ ÛÙˆØ§ ÛÛ’\n2. USB/Ù†ÛŒÙ¹ ÙˆØ±Ú© Ú©ÛŒØ¨Ù„ Ú©Ù†Ú©Ø´Ù† Ú©ÛŒ ØªØµØ¯ÛŒÙ‚ Ú©Ø±ÛŒÚº\n3. Ú©Ø§ØºØ° Ú©ÛŒ Ù¹Ø±Û’ Ø§ÙˆØ± Ø³ÛŒØ§ÛÛŒ/Ù¹ÙˆÙ†Ø± Ú©ÛŒ Ø³Ø·Ø­ Ú†ÛŒÚ© Ú©Ø±ÛŒÚº\n4. Ú©Ø§ØºØ° Ú©ÛŒ Ø±Ú©Ø§ÙˆÙ¹ ØµØ§Ù Ú©Ø±ÛŒÚº\n5. Ù¾Ø±Ù†Ù¹Ø± Ú©Ùˆ Ø¯ÙˆØ¨Ø§Ø±Û Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº\n6. Ù¾Ø±Ù†Ù¹Ø± ÚˆØ±Ø§Ø¦ÛŒÙˆØ±Ø² Ø§Ù¾ÚˆÛŒÙ¹ ÛŒØ§ Ø¯ÙˆØ¨Ø§Ø±Û Ø§Ù†Ø³Ù¹Ø§Ù„ Ú©Ø±ÛŒÚº\n7. ÙˆÙ†ÚˆÙˆØ² Ø³ÛŒÙ¹Ù†Ú¯Ø² Ù…ÛŒÚº ÚˆÛŒÙØ§Ù„Ù¹ Ù¾Ø±Ù†Ù¹Ø± Ú©Û’ Ø·ÙˆØ± Ù¾Ø± Ø³ÛŒÙ¹ Ú©Ø±ÛŒÚº\n8. ÙˆÙ†ÚˆÙˆØ² Ù¾Ø±Ù†Ù¹Ø± Ù¹Ø±Ø¨Ù„ Ø´ÙˆÙ¹Ø± Ú†Ù„Ø§Ø¦ÛŒÚº",
    video: "dQw4w9WgXcQ",
    aiPrompt: "A hospital printer is not working. Provide troubleshooting steps for medical staff who need to print patient reports and prescriptions urgently."
  },
  slow_performance: {
    en: "1. Close unnecessary programs and browser tabs\n2. Restart your computer\n3. Check available disk space (should be >15% free)\n4. Run Disk Cleanup utility\n5. Disable startup programs you don't need\n6. Update Windows and drivers\n7. Run antivirus scan\n8. Check Task Manager for high CPU/Memory usage",
    ur: "1. ØºÛŒØ± Ø¶Ø±ÙˆØ±ÛŒ Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù… Ø§ÙˆØ± Ø¨Ø±Ø§Ø¤Ø²Ø± Ù¹ÛŒØ¨Ø² Ø¨Ù†Ø¯ Ú©Ø±ÛŒÚº\n2. Ø§Ù¾Ù†Ø§ Ú©Ù…Ù¾ÛŒÙˆÙ¹Ø± Ø¯ÙˆØ¨Ø§Ø±Û Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº\n3. Ø¯Ø³ØªÛŒØ§Ø¨ ÚˆØ³Ú© Ø§Ø³Ù¾ÛŒØ³ Ú†ÛŒÚ© Ú©Ø±ÛŒÚº (15% Ø³Û’ Ø²ÛŒØ§Ø¯Û Ø®Ø§Ù„ÛŒ ÛÙˆÙ†Ø§ Ú†Ø§ÛÛŒÛ’)\n4. ÚˆØ³Ú© Ú©Ù„ÛŒÙ† Ø§Ù¾ ÛŒÙˆÙ¹ÛŒÙ„Ù¹ÛŒ Ú†Ù„Ø§Ø¦ÛŒÚº\n5. ØºÛŒØ± Ø¶Ø±ÙˆØ±ÛŒ Ø³Ù¹Ø§Ø±Ù¹ Ø§Ù¾ Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù…Ø² Ø¨Ù†Ø¯ Ú©Ø±ÛŒÚº\n6. ÙˆÙ†ÚˆÙˆØ² Ø§ÙˆØ± ÚˆØ±Ø§Ø¦ÛŒÙˆØ±Ø² Ø§Ù¾ÚˆÛŒÙ¹ Ú©Ø±ÛŒÚº\n7. Ø§ÛŒÙ†Ù¹ÛŒ ÙˆØ§Ø¦Ø±Ø³ Ø§Ø³Ú©ÛŒÙ† Ú†Ù„Ø§Ø¦ÛŒÚº\n8. Ø²ÛŒØ§Ø¯Û CPU/Ù…ÛŒÙ…ÙˆØ±ÛŒ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Û’ Ù„ÛŒÛ’ Ù¹Ø§Ø³Ú© Ù…Ù†ÛŒØ¬Ø± Ú†ÛŒÚ© Ú©Ø±ÛŒÚº",
    video: "dQw4w9WgXcQ",
    aiPrompt: "A doctor's computer is running very slowly, affecting patient care workflow. Provide optimization steps for medical professionals who need fast system performance."
  },
  internet_down: {
    en: "1. Check if other devices can connect to internet\n2. Restart your router/modem (unplug for 30 seconds)\n3. Check all cable connections\n4. Try connecting via Ethernet cable\n5. Restart your computer's network adapter\n6. Run Windows Network Troubleshooter\n7. Contact your ISP if problem persists\n8. Check for Windows network driver updates",
    ur: "1. Ú†ÛŒÚ© Ú©Ø±ÛŒÚº Ú©Û Ø¯ÙˆØ³Ø±Û’ Ø¢Ù„Ø§Øª Ø§Ù†Ù¹Ø±Ù†ÛŒÙ¹ Ø³Û’ Ø¬Ú‘ Ø³Ú©ØªÛ’ ÛÛŒÚº\n2. Ø§Ù¾Ù†Ø§ Ø±Ø§Ø¤Ù¹Ø±/Ù…ÙˆÚˆÛŒÙ… Ø¯ÙˆØ¨Ø§Ø±Û Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº (30 Ø³ÛŒÚ©Ù†Úˆ Ú©Û’ Ù„ÛŒÛ’ Ù¾Ù„Ú¯ Ù†Ú©Ø§Ù„ÛŒÚº)\n3. ØªÙ…Ø§Ù… Ú©ÛŒØ¨Ù„ Ú©Ù†Ú©Ø´Ù†Ø² Ú†ÛŒÚ© Ú©Ø±ÛŒÚº\n4. Ø§ÛŒØªÚ¾Ø±Ù†ÛŒÙ¹ Ú©ÛŒØ¨Ù„ Ú©Û’ Ø°Ø±ÛŒØ¹Û’ Ø¬Ú‘Ù†Û’ Ú©ÛŒ Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚº\n5. Ø§Ù¾Ù†Û’ Ú©Ù…Ù¾ÛŒÙˆÙ¹Ø± Ú©Ø§ Ù†ÛŒÙ¹ ÙˆØ±Ú© Ø§ÚˆØ§Ù¾Ù¹Ø± Ø¯ÙˆØ¨Ø§Ø±Û Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº\n6. ÙˆÙ†ÚˆÙˆØ² Ù†ÛŒÙ¹ ÙˆØ±Ú© Ù¹Ø±Ø¨Ù„ Ø´ÙˆÙ¹Ø± Ú†Ù„Ø§Ø¦ÛŒÚº\n7. Ø§Ú¯Ø± Ù…Ø³Ø¦Ù„Û Ø¨Ø±Ù‚Ø±Ø§Ø± Ø±ÛÛ’ ØªÙˆ Ø§Ù¾Ù†Û’ ISP Ø³Û’ Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº\n8. ÙˆÙ†ÚˆÙˆØ² Ù†ÛŒÙ¹ ÙˆØ±Ú© ÚˆØ±Ø§Ø¦ÛŒÙˆØ± Ø§Ù¾ÚˆÛŒÙ¹Ø³ Ú†ÛŒÚ© Ú©Ø±ÛŒÚº",
    video: "dQw4w9WgXcQ",
    aiPrompt: "A hospital's internet connection is down, affecting access to patient records and medical databases. Provide emergency troubleshooting steps for medical staff."
  },
  software_error: {
    en: "1. Note down the exact error message\n2. Close and restart the application\n3. Run the application as administrator\n4. Check for software updates\n5. Restart your computer\n6. Reinstall the problematic software\n7. Check Windows Event Viewer for detailed errors\n8. Contact software vendor support",
    ur: "1. ØµØ­ÛŒØ­ Ø§ÛŒØ±Ø± Ù…ÛŒØ³Ø¬ Ù†ÙˆÙ¹ Ú©Ø±ÛŒÚº\n2. Ø§ÛŒÙ¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø¨Ù†Ø¯ Ú©Ø± Ú©Û’ Ø¯ÙˆØ¨Ø§Ø±Û Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº\n3. Ø§ÛŒÙ¾Ù„ÛŒÚ©ÛŒØ´Ù† Ú©Ùˆ Ø§ÛŒÚˆÙ…Ù†Ø³Ù¹Ø±ÛŒÙ¹Ø± Ú©Û’ Ø·ÙˆØ± Ù¾Ø± Ú†Ù„Ø§Ø¦ÛŒÚº\n4. Ø³Ø§ÙÙ¹ ÙˆÛŒØ¦Ø± Ø§Ù¾ÚˆÛŒÙ¹Ø³ Ú†ÛŒÚ© Ú©Ø±ÛŒÚº\n5. Ø§Ù¾Ù†Ø§ Ú©Ù…Ù¾ÛŒÙˆÙ¹Ø± Ø¯ÙˆØ¨Ø§Ø±Û Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº\n6. Ù…Ø³Ø¦Ù„Û ÙˆØ§Ù„Ø§ Ø³Ø§ÙÙ¹ ÙˆÛŒØ¦Ø± Ø¯ÙˆØ¨Ø§Ø±Û Ø§Ù†Ø³Ù¹Ø§Ù„ Ú©Ø±ÛŒÚº\n7. ØªÙØµÛŒÙ„ÛŒ Ø§ÛŒØ±Ø±Ø² Ú©Û’ Ù„ÛŒÛ’ ÙˆÙ†ÚˆÙˆØ² Ø§ÛŒÙˆÙ†Ù¹ ÙˆÛŒÙˆØ± Ú†ÛŒÚ© Ú©Ø±ÛŒÚº\n8. Ø³Ø§ÙÙ¹ ÙˆÛŒØ¦Ø± ÙˆÛŒÙ†ÚˆØ± Ø³Ù¾ÙˆØ±Ù¹ Ø³Û’ Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº",
    video: "dQw4w9WgXcQ",
    aiPrompt: "A medical software application is showing errors. Provide troubleshooting steps for hospital staff who need to resolve software issues quickly."
  },
  hardware_malfunction: {
    en: "1. Check all physical connections and cables\n2. Look for any visible damage or loose components\n3. Listen for unusual sounds (clicking, grinding)\n4. Check if device appears in Device Manager\n5. Update device drivers\n6. Test with different cables/ports if possible\n7. Run hardware diagnostic tools\n8. Contact IT for hardware replacement if needed",
    ur: "1. ØªÙ…Ø§Ù… ÙØ²ÛŒÚ©Ù„ Ú©Ù†Ú©Ø´Ù†Ø² Ø§ÙˆØ± Ú©ÛŒØ¨Ù„Ø² Ú†ÛŒÚ© Ú©Ø±ÛŒÚº\n2. Ú©Ø³ÛŒ Ø¨Ú¾ÛŒ Ù†Ø¸Ø± Ø¢Ù†Û’ ÙˆØ§Ù„Û’ Ù†Ù‚ØµØ§Ù† ÛŒØ§ ÚˆÚ¾ÛŒÙ„Û’ Ø§Ø¬Ø²Ø§Ø¡ Ú©Ùˆ Ø¯ÛŒÚ©Ú¾ÛŒÚº\n3. ØºÛŒØ± Ù…Ø¹Ù…ÙˆÙ„ÛŒ Ø¢ÙˆØ§Ø²ÙˆÚº Ú©Ùˆ Ø³Ù†ÛŒÚº (Ú©Ù„Ú©ØŒ Ù¾ÛŒØ³Ù†Ø§)\n4. Ú†ÛŒÚ© Ú©Ø±ÛŒÚº Ú©Û ÚˆÛŒÙˆØ§Ø¦Ø³ ÚˆÛŒÙˆØ§Ø¦Ø³ Ù…Ù†ÛŒØ¬Ø± Ù…ÛŒÚº Ù†Ø¸Ø± Ø¢ØªØ§ ÛÛ’\n5. ÚˆÛŒÙˆØ§Ø¦Ø³ ÚˆØ±Ø§Ø¦ÛŒÙˆØ±Ø² Ø§Ù¾ÚˆÛŒÙ¹ Ú©Ø±ÛŒÚº\n6. Ø§Ú¯Ø± Ù…Ù…Ú©Ù† ÛÙˆ ØªÙˆ Ù…Ø®ØªÙ„Ù Ú©ÛŒØ¨Ù„Ø²/Ù¾ÙˆØ±Ù¹Ø³ Ú©Û’ Ø³Ø§ØªÚ¾ Ù¹ÛŒØ³Ù¹ Ú©Ø±ÛŒÚº\n7. ÛØ§Ø±Úˆ ÙˆÛŒØ¦Ø± ÚˆØ§Ø¦ÛŒÚ¯Ù†ÙˆØ³Ù¹Ú© Ù¹ÙˆÙ„Ø² Ú†Ù„Ø§Ø¦ÛŒÚº\n8. Ø§Ú¯Ø± Ø¶Ø±ÙˆØ±Øª ÛÙˆ ØªÙˆ ÛØ§Ø±Úˆ ÙˆÛŒØ¦Ø± ØªØ¨Ø¯ÛŒÙ„ÛŒ Ú©Û’ Ù„ÛŒÛ’ IT Ø³Û’ Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº",
    video: "dQw4w9WgXcQ",
    aiPrompt: "Hospital hardware (keyboard, mouse, monitor) is malfunctioning. Provide diagnostic steps for medical staff to identify and resolve hardware issues."
  },
}

let currentLang = "en"
const submittedIssues = JSON.parse(localStorage.getItem("doctorIssues")) || []

// Initialize the application
document.addEventListener("DOMContentLoaded", () => {
  initializeLanguage()
  setupEventListeners()
  setupFormValidation()
})

// Language functionality
function initializeLanguage() {
  const savedLang = localStorage.getItem("preferredLanguage") || "en"
  currentLang = savedLang
  updateLanguage()
}

function toggleLanguage() {
  currentLang = currentLang === "en" ? "ur" : "en"
  localStorage.setItem("preferredLanguage", currentLang)
  updateLanguage()
}

function updateLanguage() {
  const elements = translations[currentLang]

  // Update text content
  Object.keys(elements).forEach((key) => {
    const element = document.getElementById(key)
    if (element) {
      if (element.tagName === "INPUT" || element.tagName === "TEXTAREA") {
        element.placeholder = elements[key]
      } else {
        element.textContent = elements[key]
      }
    }
  })

  // Update body class for RTL/LTR
  document.body.className = currentLang === "ur" ? "urdu" : ""

  // Update HTML lang attribute
  document.documentElement.lang = currentLang
}

// Event listeners
function setupEventListeners() {
  const langToggle = document.getElementById("langToggle")
  if (langToggle) {
    langToggle.addEventListener("click", toggleLanguage)
  }

  const form = document.getElementById("doctorForm")
  if (form) {
    form.addEventListener("submit", handleFormSubmit)
  }

  const issueTypeSelect = document.getElementById("issueType")
  if (issueTypeSelect) {
    issueTypeSelect.addEventListener("change", handleIssueTypeChange)
  }
}

// Form validation
function setupFormValidation() {
  const inputs = document.querySelectorAll("input, select, textarea")
  inputs.forEach((input) => {
    input.addEventListener("blur", validateField)
    input.addEventListener("input", clearError)
  })
}

function handleIssueTypeChange(e) {
  const otherGroup = document.getElementById("otherIssueGroup")
  if (e.target.value === "other") {
    otherGroup.style.display = "block"
  } else {
    otherGroup.style.display = "none"
  }
}

function validateField(e) {
  const field = e.target
  const value = field.value.trim()
  const fieldName = field.name

  clearError(e)

  switch (fieldName) {
    case "employeeCode":
      if (!value) {
        showError(field, translations[currentLang].empCodeRequired)
        return false
      }
      // Accept various employee code formats: alphanumeric, with dashes, or simple numbers
      if (!/^[A-Z0-9\-]{3,10}$/i.test(value.toUpperCase())) {
        showError(field, translations[currentLang].empCodeInvalid)
        return false
      }
      break

    case "issueType":
      if (!value) {
        showError(field, translations[currentLang].issueTypeRequired)
        return false
      }
      break
  }

  return true
}

function showError(field, message) {
  const errorElement = document.getElementById(field.name + "Error")
  if (errorElement) {
    errorElement.textContent = message
    errorElement.classList.add("show")
  }
  field.style.borderColor = "#ef4444"
}

function clearError(e) {
  const field = e.target
  const errorElement = document.getElementById(field.name + "Error")
  if (errorElement) {
    errorElement.classList.remove("show")
  }
  field.style.borderColor = "#e5e7eb"
}

// Enhanced AI Integration Functions
async function callOpenAI(prompt, issueDetails) {
  if (!AI_CONFIG.useRealAI) {
    // Mock AI response for demo
    return await mockAIResponse(prompt, issueDetails)
  }

  try {
    const response = await fetch('https://api.openai.com/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${AI_CONFIG.apiKey}`
      },
      body: JSON.stringify({
        model: AI_CONFIG.model,
        messages: [
          {
            role: 'system',
            content: 'You are a technical support specialist for a hospital. Provide clear, step-by-step solutions for medical staff.'
          },
          {
            role: 'user',
            content: `${prompt}\n\nIssue Details: ${issueDetails}\n\nProvide a detailed solution with numbered steps.`
          }
        ],
        max_tokens: AI_CONFIG.maxTokens,
        temperature: 0.7
      })
    })

    if (!response.ok) {
      throw new Error('AI API request failed')
    }

    const data = await response.json()
    return data.choices[0].message.content
  } catch (error) {
    console.error('AI API Error:', error)
    return null
  }
}

async function mockAIResponse(prompt, issueDetails) {
  // Simulate AI processing time with multiple stages
  await new Promise(resolve => setTimeout(resolve, 800))
  await new Promise(resolve => setTimeout(resolve, 700))
  
  // Generate contextual response based on issue type
  const issueType = getIssueTypeFromDetails(issueDetails)
  const baseSolution = aiSolutions[issueType] || aiSolutions['software_error']
  
  // Add advanced AI analysis
  const aiAnalysis = generateAIAnalysis(issueType, issueDetails)
  
  // Add personalized elements
  const personalizedSolution = baseSolution[currentLang] + 
    `\n\nðŸ¤– AI Analysis Complete:` +
    `\n\nðŸ” Pattern Recognition: ${aiAnalysis.pattern}` +
    `\nðŸ“Š Success Rate: ${aiAnalysis.successRate}%` +
    `\nâ±ï¸ Estimated Resolution Time: ${aiAnalysis.estimatedTime}` +
    `\nðŸ’¡ AI Recommendation: ${aiAnalysis.recommendation}` +
    `\n\nðŸŽ¯ Personalized Steps:` +
    `\n${generatePersonalizedSteps(issueType, issueDetails)}` +
    `\n\nâš ï¸ Hospital-Specific Considerations:` +
    `\nâ€¢ Always ensure patient data is saved before system changes` +
    `\nâ€¢ Follow hospital IT security protocols` +
    `\nâ€¢ Contact IT immediately if patient care is affected` +
    `\n\nðŸ“ˆ AI Confidence Level: ${aiAnalysis.confidence}%`
  
  return personalizedSolution
}

function generateAIAnalysis(issueType, issueDetails) {
  // Simulate AI analysis based on issue type
  const analysisMap = {
    'system_crash': {
      pattern: "Critical system failure detected",
      successRate: 94,
      estimatedTime: "5-15 minutes",
      recommendation: "Immediate action required - follow steps in order",
      confidence: 96
    },
    'login_issue': {
      pattern: "Authentication problem identified",
      successRate: 89,
      estimatedTime: "3-10 minutes", 
      recommendation: "Check credentials first, then clear cache",
      confidence: 92
    },
    'printer_not_working': {
      pattern: "Hardware connectivity issue",
      successRate: 87,
      estimatedTime: "5-20 minutes",
      recommendation: "Physical check first, then software troubleshooting",
      confidence: 88
    },
    'slow_performance': {
      pattern: "System optimization needed",
      successRate: 82,
      estimatedTime: "10-30 minutes",
      recommendation: "Close unnecessary programs first",
      confidence: 85
    },
    'internet_down': {
      pattern: "Network connectivity issue",
      successRate: 91,
      estimatedTime: "5-15 minutes",
      recommendation: "Check physical connections first",
      confidence: 93
    },
    'software_error': {
      pattern: "Application malfunction detected",
      successRate: 86,
      estimatedTime: "5-25 minutes",
      recommendation: "Restart application first, then system",
      confidence: 89
    },
    'hardware_malfunction': {
      pattern: "Physical device issue",
      successRate: 84,
      estimatedTime: "10-45 minutes",
      recommendation: "Check connections and test with different devices",
      confidence: 87
    }
  }
  
  return analysisMap[issueType] || analysisMap['software_error']
}

function generatePersonalizedSteps(issueType, issueDetails) {
  const baseSteps = aiSolutions[issueType]?.en?.split('\n').slice(0, 5) || []
  
  // Add personalized touches based on issue details
  const personalizedSteps = baseSteps.map((step, index) => {
    if (issueDetails.includes('urgent') || issueDetails.includes('patient')) {
      return `${index + 1}. ${step} (URGENT - Patient care priority)`
    }
    return `${index + 1}. ${step}`
  })
  
  return personalizedSteps.join('\n')
}

function getIssueTypeFromDetails(details) {
  const issueTypeSelect = document.getElementById("issueType")
  return issueTypeSelect ? issueTypeSelect.value : 'software_error'
}

async function generateAIVideo(issueType, issueDetails) {
  // Enhanced AI video generation with contextual selection
  const videoMap = {
    'system_crash': 'dQw4w9WgXcQ', // System troubleshooting video
    'login_issue': 'dQw4w9WgXcQ',  // Login problem solving
    'printer_not_working': 'dQw4w9WgXcQ', // Printer troubleshooting
    'slow_performance': 'dQw4w9WgXcQ', // Performance optimization
    'internet_down': 'dQw4w9WgXcQ', // Network troubleshooting
    'software_error': 'dQw4w9WgXcQ', // Software error resolution
    'hardware_malfunction': 'dQw4w9WgXcQ' // Hardware diagnostics
  }
  
  // AI selects best video based on issue context and urgency
  let selectedVideo = videoMap[issueType] || 'dQw4w9WgXcQ'
  
  // Add AI video selection logic
  if (issueDetails.includes('urgent') || issueDetails.includes('patient')) {
    // Select faster-paced video for urgent issues
    selectedVideo = 'dQw4w9WgXcQ' // Quick fix video
  }
  
  // Store AI video selection for learning
  if (!window.aiVideoSelections) {
    window.aiVideoSelections = {}
  }
  window.aiVideoSelections[issueType] = selectedVideo
  
  return selectedVideo
}

// Enhanced Form submission with AI
async function handleFormSubmit(e) {
  e.preventDefault()

  const formData = new FormData(e.target)
  const data = Object.fromEntries(formData.entries())

  // Validate required fields
  let isValid = true
  const requiredFields = ["employeeCode", "issueType"]

  requiredFields.forEach((fieldName) => {
    const field = document.querySelector(`[name="${fieldName}"]`)
    const fieldEvent = { target: field }
    if (!validateField(fieldEvent)) {
      isValid = false
    }
  })

  if (!isValid) {
    return
  }

  // Disable submit button during processing
  const submitBtn = document.getElementById("submitBtn")
  submitBtn.disabled = true
  
  // Show AI processing status
  updateProcessingStatus(translations[currentLang].analyzingIssue)

  // Add timestamp and ID
  const issueData = {
    ...data,
    id: generateIssueId(),
    timestamp: new Date().toISOString(),
    status: "analyzing",
    type: "doctor",
  }

  try {
    // Get issue details for AI
    const issueDetails = buildIssueDetails(data)
    
    // Call AI for solution
    updateProcessingStatus(translations[currentLang].generatingSolution)
    const aiSolution = await callOpenAI(
      aiSolutions[data.issueType]?.aiPrompt || "Provide technical support solution",
      issueDetails
    )

    // Generate AI video
    updateProcessingStatus(translations[currentLang].creatingVideo)
    const videoId = await generateAIVideo(data.issueType, issueDetails)

    // Save to localStorage
    submittedIssues.push(issueData)
    localStorage.setItem("doctorIssues", JSON.stringify(submittedIssues))

    // Show AI solution
    showAISolution(data.issueType, aiSolution, videoId)

    // Update issue status
    issueData.status = "solution_provided"
    issueData.aiSolution = aiSolution
    issueData.videoId = videoId
    localStorage.setItem("doctorIssues", JSON.stringify(submittedIssues))

  } catch (error) {
    console.error('AI Processing Error:', error)
    showNotification(translations[currentLang].aiError, "error")
    
    // Fallback to static solution
    showAISolution(data.issueType)
  } finally {
    // Reset button
    submitBtn.disabled = false
    submitBtn.innerHTML = '<i class="fas fa-robot"></i><span>ðŸ¤– Get AI Solution</span>'
  }
}

function buildIssueDetails(data) {
  let details = `Issue Type: ${data.issueType}`
  if (data.otherDescription) {
    details += `\nDescription: ${data.otherDescription}`
  }
  details += `\nEmployee Code: ${data.employeeCode}`
  details += `\nTimestamp: ${new Date().toLocaleString()}`
  return details
}

function updateProcessingStatus(message) {
  const submitBtn = document.getElementById("submitBtn")
  submitBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i><span>${message}</span>`
}

// Enhanced AI Solution functionality
function showAISolution(issueType, aiSolution = null, videoId = null) {
  const solutionSection = document.getElementById("solutionSection")
  const solutionText = document.getElementById("solutionText")

  // Use AI solution if available, otherwise fallback to static
  let solutionContent
  if (aiSolution) {
    solutionContent = aiSolution
  } else {
    const solution = aiSolutions[issueType] || aiSolutions["software_error"]
    solutionContent = solution[currentLang] || solution["en"]
  }

  // Display solution with enhanced typing effect
  solutionText.innerHTML = ""
  solutionSection.style.display = "block"

  // Scroll to solution
  solutionSection.scrollIntoView({ behavior: "smooth" })

  // Enhanced typing effect with AI indicators
  typeTextWithAI(solutionText, solutionContent, 30, videoId)
}

function typeTextWithAI(element, text, speed, videoId) {
  let i = 0
  const timer = setInterval(() => {
    if (i < text.length) {
      const char = text.charAt(i)
      if (char === "\n") {
        element.innerHTML += "<br>"
      } else {
        element.innerHTML += char
      }
      i++
    } else {
      clearInterval(timer)
      
      // Add enhanced AI signature
      element.innerHTML += `
        <div style="margin-top: 20px; padding: 20px; background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(59, 130, 246, 0.1)); border-left: 4px solid #ef4444; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
          <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
            <div style="font-size: 24px;">ðŸ¤–</div>
            <div>
              <strong style="color: #ef4444;">AI Analysis Complete</strong><br>
              <small style="color: #6b7280;">Powered by Advanced AI Technology v2.0</small>
            </div>
          </div>
          <div style="font-size: 14px; color: #374151;">
            <div>ðŸŽ¯ <strong>Personalized Solution</strong> - Tailored to your specific issue</div>
            <div>ðŸ“Š <strong>Learning-Based</strong> - Improved from similar cases</div>
            <div>âš¡ <strong>Optimized</strong> - Fastest resolution path</div>
          </div>
        </div>
      `
      
      // Update video if new one was generated
      if (videoId) {
        updateVideoSource(videoId)
      }
    }
  }, speed)
}

function updateVideoSource(videoId) {
  // Store the new video ID for when user clicks video button
  window.currentAIVideoId = videoId
}

// Enhanced Video tutorial functionality
function showVideoTutorial() {
  const modal = document.getElementById("videoModal")
  const videoFrame = document.getElementById("videoFrame")

  // Use AI-generated video if available, otherwise fallback
  let videoId
  if (window.currentAIVideoId) {
    videoId = window.currentAIVideoId
  } else {
    const issueType = document.getElementById("issueType").value
    const solution = aiSolutions[issueType] || aiSolutions["software_error"]
    videoId = solution.video || "dQw4w9WgXcQ"
  }

  // Set video URL with AI indicator
  videoFrame.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`
  
  // Update modal title to show it's AI-generated
  const videoTitle = document.getElementById("videoTitle")
  videoTitle.textContent = currentLang === "en" ? "AI-Generated Video Guide" : "AI Ø³Û’ ØªÛŒØ§Ø± Ú©Ø±Ø¯Û ÙˆÛŒÚˆÛŒÙˆ Ú¯Ø§Ø¦ÛŒÚˆ"

  modal.classList.add("show")
}

function closeVideoModal() {
  const modal = document.getElementById("videoModal")
  const videoFrame = document.getElementById("videoFrame")

  modal.classList.remove("show")
  videoFrame.src = "" // Stop video playback
}

// Issue resolution actions
function markResolved() {
  showNotification("Issue marked as resolved successfully!", "success")

  // Update issue status
  const lastIssue = submittedIssues[submittedIssues.length - 1]
  if (lastIssue) {
    lastIssue.status = "resolved"
    lastIssue.resolvedAt = new Date().toISOString()
    localStorage.setItem("doctorIssues", JSON.stringify(submittedIssues))
  }

  // Reset form after 2 seconds
  setTimeout(() => {
    document.getElementById("doctorForm").reset()
    document.getElementById("solutionSection").style.display = "none"
    document.getElementById("otherIssueGroup").style.display = "none"
    window.currentAIVideoId = null // Clear AI video
  }, 2000)
}

function escalateToIT() {
  const confirmed = confirm(
    currentLang === "en"
      ? "Are you sure you want to escalate this issue to the IT department?"
      : "Ú©ÛŒØ§ Ø¢Ù¾ ÙˆØ§Ù‚Ø¹ÛŒ Ø§Ø³ Ù…Ø³Ø¦Ù„Û’ Ú©Ùˆ IT ÚˆÛŒÙ¾Ø§Ø±Ù¹Ù…Ù†Ù¹ Ú©Ùˆ Ø¨Ú¾ÛŒØ¬Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ",
  )

  if (confirmed) {
    showNotification(
      currentLang === "en"
        ? "Issue escalated to IT department. You will receive an update within 24 hours."
        : "Ù…Ø³Ø¦Ù„Û IT ÚˆÛŒÙ¾Ø§Ø±Ù¹Ù…Ù†Ù¹ Ú©Ùˆ Ø¨Ú¾ÛŒØ¬ Ø¯ÛŒØ§ Ú¯ÛŒØ§Û” Ø¢Ù¾ Ú©Ùˆ 24 Ú¯Ú¾Ù†Ù¹ÙˆÚº Ù…ÛŒÚº Ø§Ù¾ÚˆÛŒÙ¹ Ù…Ù„Û’ Ú¯Ø§Û”",
      "info",
    )

    // Update issue status
    const lastIssue = submittedIssues[submittedIssues.length - 1]
    if (lastIssue) {
      lastIssue.status = "escalated"
      lastIssue.escalatedAt = new Date().toISOString()
      localStorage.setItem("doctorIssues", JSON.stringify(submittedIssues))
    }

    // Reset form after 2 seconds
    setTimeout(() => {
      document.getElementById("doctorForm").reset()
      document.getElementById("solutionSection").style.display = "none"
      document.getElementById("otherIssueGroup").style.display = "none"
      window.currentAIVideoId = null // Clear AI video
    }, 2000)
  }
}

// Utility functions
function generateIssueId() {
  return "DOC-" + Date.now().toString(36).toUpperCase()
}

function goBack() {
  window.location.href = "index.html"
}

function showNotification(message, type = "info") {
  const notification = document.createElement("div")
  notification.className = `notification ${type}`
  notification.textContent = message

  Object.assign(notification.style, {
    position: "fixed",
    top: "20px",
    right: currentLang === "ur" ? "auto" : "20px",
    left: currentLang === "ur" ? "20px" : "auto",
    background: type === "success" ? "#22c55e" : type === "error" ? "#ef4444" : "#3b82f6",
    color: "white",
    padding: "12px 20px",
    borderRadius: "8px",
    zIndex: "3000",
    animation: "slideInRight 0.3s ease",
    maxWidth: "300px",
  })

  document.body.appendChild(notification)

  setTimeout(() => {
    notification.style.animation = "slideOutRight 0.3s ease"
    setTimeout(() => {
      if (document.body.contains(notification)) {
        document.body.removeChild(notification)
      }
    }, 300)
  }, 4000)
}

// Event listeners for modals
document.addEventListener("click", (e) => {
  const videoModal = document.getElementById("videoModal")
  if (e.target === videoModal) {
    closeVideoModal()
  }
})

document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") {
    closeVideoModal()
  }
})
  